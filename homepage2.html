<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GharBageecha - Rooftop Farming Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" />
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #e5e7eb;
            min-height: 100vh;
            overflow-x: hidden;
        }
        
        /* Animated Background */
        .animated-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            background: linear-gradient(135deg, #f3f4f6 0%, #e5e7eb 100%);
        }
        
        .animated-bg::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%234CAF50' fill-opacity='0.05'%3E%3Ccircle cx='30' cy='30' r='2'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E") repeat;
            animation: float 3s ease-in-out infinite;
        }
        
        @keyframes float {
            0%, 100% { transform: translateY(0px); }
            50% { transform: translateY(-20px); }
        }
        
        /* Glassmorphism Effect */
        .glass {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 8px 32px 0 rgba(76, 175, 80, 0.1);
        }
        
        .glass-white {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 8px 32px 0 rgba(76, 175, 80, 0.15);
        }
        
        /* Custom Colors */
        .text-green-500 { color: #4CAF50; }
        .bg-green-500 { background-color: #4CAF50; }
        .bg-green-600 { background-color: #388E3C; }
        .text-lime-500 { color: #8BC34A; }
        .bg-lime-500 { background-color: #8BC34A; }
        .text-gray-600 { color: #6b7280; }
        .text-gray-900 { color: #1f2937; }
        .bg-gray-100 { background-color: #f3f4f6; }
        .bg-gray-200 { background-color: #e5e7eb; }
        
        /* Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes fadeInLeft {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes fadeInRight {
            from {
                opacity: 0;
                transform: translateX(30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% { transform: translateY(0); }
            40%, 43% { transform: translateY(-30px); }
            70% { transform: translateY(-15px); }
            90% { transform: translateY(-4px); }
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        /* Utility Classes */
        .animate-fadeInUp {
            animation: fadeInUp 0.8s ease-out forwards;
        }
        
        .animate-fadeInLeft {
            animation: fadeInLeft 0.8s ease-out forwards;
        }
        
        .animate-fadeInRight {
            animation: fadeInRight 0.8s ease-out forwards;
        }
        
        .animate-pulse-custom {
            animation: pulse 2s 2;
            animation-fill-mode: forwards;
        }
        
        .animate-bounce-custom {
            animation: bounce 2s 2;
            animation-fill-mode: forwards;
        }
        
        .animate-gradient {
            background: linear-gradient(-45deg, #4CAF50, #388E3C, #8BC34A, #4CAF50);
            background-size: 400% 400%;
            animation: gradient 3s ease infinite;
        }
        
        /* Hover Effects */
        .hover-lift {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .hover-lift:hover {
            transform: translateY(-8px);
            box-shadow: 0 20px 40px rgba(76, 175, 80, 0.2);
        }
        
        .hover-glow:hover {
            box-shadow: 0 0 20px rgba(76, 175, 80, 0.5);
        }
        
        /* Button Styles */
        .btn-primary {
            background: linear-gradient(135deg, #4CAF50, #388E3C);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        
        .btn-primary::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }
        
        .btn-primary:hover::before {
            left: 100%;
        }
        
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(76, 175, 80, 0.3);
        }
        
        /* Loading Animation */
        .loading-dots {
            display: inline-block;
        }
        
        .loading-dots::after {
            content: '';
            animation: dots 1.5s steps(5, end) infinite;
        }
        
        @keyframes dots {
            0%, 20% { content: ''; }
            40% { content: '.'; }
            60% { content: '..'; }
            80%, 100% { content: '...'; }
        }
        
        /* Form Enhancements */
        .form-input {
            transition: all 0.3s ease;
            border: 2px solid #e5e7eb;
            background-color: #ffffff;
        }
        
        .form-input:focus {
            border-color: #4CAF50;
            box-shadow: 0 0 0 3px rgba(76, 175, 80, 0.1);
            transform: translateY(-2px);
        }
        
        /* Card Hover Effects */
        .card-hover {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .card-hover:hover {
            transform: translateY(-5px) scale(1.02);
            box-shadow: 0 15px 35px rgba(76, 175, 80, 0.15);
        }
        
        /* Navigation Enhancement */
        .nav-link {
            position: relative;
            transition: all 0.3s ease;
        }
        
        .nav-link::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 0;
            width: 0;
            height: 2px;
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            transition: width 0.3s ease;
        }
        
        .nav-link:hover::after {
            width: 100%;
        }
        
        /* Typing Animation */
        .typing-animation {
            border-right: 2px solid #4CAF50;
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0%, 50% { border-color: transparent; }
            51%, 100% { border-color: #4CAF50; }
        }
        
        /* Particle Effect */
        .particles {
            position: absolute;
            width: 100%;
            height: 100%;
            overflow: hidden;
            pointer-events: none;
        }
        
        .particle {
            position: absolute;
            width: 4px;
            height: 4px;
            background: rgba(76, 175, 80, 0.3);
            border-radius: 50%;
            animation: particleFloat 3s infinite linear;
        }
        
        @keyframes particleFloat {
            0% {
                transform: translateY(100vh) rotate(0deg);
                opacity: 0;
            }
            10% {
                opacity: 1;
            }
            90% {
                opacity: 1;
            }
            100% {
                transform: translateY(-100vh) rotate(360deg);
                opacity: 0;
            }
        }
        
        /* Responsive Enhancements */
        @media (max-width: 768px) {
            .animate-fadeInLeft,
            .animate-fadeInRight {
                animation: fadeInUp 0.8s ease-out forwards;
            }
        }
        
        /* Scroll Reveal */
        .scroll-reveal {
            opacity: 0;
            transform: translateY(50px);
            transition: all 0.8s ease;
        }
        
        .scroll-reveal.revealed {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Progress Bar */
        .progress-bar {
            height: 4px;
            background: linear-gradient(135deg, #4CAF50, #8BC34A);
            border-radius: 2px;
            transition: width 0.3s ease;
        }

        /* Green Icon Animations - Limited to 2 bounces */
        .green-icon-bounce {
            animation: bounce 2s 2;
            animation-fill-mode: forwards;
        }

        .green-icon-pulse {
            animation: pulse 2s 2;
            animation-fill-mode: forwards;
        }
    </style>
</head>
<body class="text-gray-900">
    <!-- Animated Background -->
    <div class="animated-bg"></div>
    
    <!-- Particles -->
    <div class="particles" id="particles"></div>
    
    <!-- Main Navigation -->
    <nav class="glass fixed top-0 w-full z-50 p-4 transition-all duration-300" id="navbar">
        <div class="container mx-auto flex justify-between items-center">
            <a href="#" id="nav-home" class="flex items-center space-x-2 hover-lift">
                <div class="relative">
                    <svg width="40" height="40" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-green-500 green-icon-pulse">
                        <path d="M16 32L32 18L48 32V50C48 51.1 47.1 52 46 52H18C16.9 52 16 51.1 16 50V32Z" stroke="currentColor" stroke-width="3" fill="none"/>
                        <path d="M28 52V38H36V52" stroke="currentColor" stroke-width="3"/>
                        <path d="M40 12C40 8 44 6 48 6V12C48 16 44 18 40 18H34C34 14 36 12 40 12Z" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                </div>
                <span class="text-xl font-bold text-gray-900">Ghar<span class="text-lime-500">Bageecha</span></span>
            </a>
            <div class="flex space-x-6">
                <a href="#" id="nav-home-2" class="nav-link text-gray-600 hover:text-green-500 font-medium">Home</a>
                <a href="#" id="nav-planner" class="nav-link text-gray-600 hover:text-green-500 font-medium">Planner</a>
                <a href="#" id="nav-community" class="nav-link text-gray-600 hover:text-green-500 font-medium">Community</a>
                <a href="#" id="nav-resources" class="nav-link text-gray-600 hover:text-green-500 font-medium">Resources</a>
            </div>
        </div>
    </nav>

    <!-- Main Content Area -->
    <main class="pt-20 p-6">
        <!-- Home Page -->
        <div id="home" class="page-content container mx-auto">
            <!-- Hero Section -->
            <section class="text-center py-20 glass-white rounded-3xl shadow-2xl mb-12 relative overflow-hidden">
                <div class="absolute inset-0 animate-gradient opacity-10"></div>
                <div class="relative z-10">
                    <h1 class="text-6xl font-extrabold text-gray-900 mb-6 animate-fadeInUp typing-animation">
                        Cultivate Your Concrete Jungle.
                    </h1>
                    <p class="text-xl text-gray-600 mb-10 max-w-3xl mx-auto animate-fadeInUp" style="animation-delay: 0.2s;">
                        Turn your unused rooftop into a thriving garden. Get personalized plans, connect with a community, and grow fresh food right in the city.
                    </p>
                    <button id="start-planner-btn" class="btn-primary text-white font-bold py-4 px-10 rounded-full shadow-2xl hover-glow animate-bounce-custom text-lg">
                        <i class="fas fa-rocket mr-2"></i>Start Your Rooftop Garden
                    </button>
                </div>
            </section>

            <!-- Benefits Section -->
            <section class="py-16 glass-white rounded-3xl shadow-2xl mb-12 scroll-reveal">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-12 animate-fadeInUp">Why Rooftop Farming?</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 px-8">
                    <div class="card-hover glass p-8 rounded-2xl text-center hover-lift">
                        <div class="text-6xl text-green-500 mb-6 green-icon-bounce">
                            <i class="fa-solid fa-seedling"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4">Fresh, Local Food</h3>
                        <p class="text-gray-600 leading-relaxed">Harvest organic produce just steps from your kitchen, reducing food miles and waste.</p>
                    </div>
                    <div class="card-hover glass p-8 rounded-2xl text-center hover-lift" style="animation-delay: 0.2s;">
                        <div class="text-6xl text-green-500 mb-6 green-icon-bounce" style="animation-delay: 0.5s;">
                            <i class="fa-solid fa-city"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4">Urban Resilience</h3>
                        <p class="text-gray-600 leading-relaxed">Contribute to local food security and reduce the urban heat island effect.</p>
                    </div>
                    <div class="card-hover glass p-8 rounded-2xl text-center hover-lift" style="animation-delay: 0.4s;">
                        <div class="text-6xl text-green-500 mb-6 green-icon-bounce" style="animation-delay: 1s;">
                            <i class="fa-solid fa-wallet"></i>
                        </div>
                        <h3 class="text-2xl font-bold text-gray-900 mb-4">Save Money</h3>
                        <p class="text-gray-600 leading-relaxed">Grow your own food and significantly cut down on your grocery bills over time.</p>
                    </div>
                </div>
            </section>

            <!-- Statistics Section -->
            <section class="py-16 animate-gradient text-white rounded-3xl shadow-2xl mb-12 scroll-reveal">
                <h2 class="text-4xl font-bold text-center mb-10">Did You Know?</h2>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 px-8 text-center">
                    <div class="glass p-8 rounded-2xl hover-lift">
                        <div class="text-5xl mb-6 green-icon-pulse">
                            <i class="fa-solid fa-cloud-sun-rain"></i>
                        </div>
                        <p class="text-lg leading-relaxed">Rooftop gardens can reduce a building's cooling costs by up to 25%.</p>
                    </div>
                    <div class="glass p-8 rounded-2xl hover-lift" style="animation-delay: 0.2s;">
                        <div class="text-5xl mb-6 green-icon-pulse" style="animation-delay: 0.5s;">
                            <i class="fa-solid fa-leaf"></i>
                        </div>
                        <p class="text-lg leading-relaxed">A typical 1000 sq ft rooftop farm can produce over 2000 lbs of vegetables annually.</p>
                    </div>
                    <div class="glass p-8 rounded-2xl hover-lift" style="animation-delay: 0.4s;">
                        <div class="text-5xl mb-6 green-icon-pulse" style="animation-delay: 1s;">
                            <i class="fa-solid fa-water"></i>
                        </div>
                        <p class="text-lg leading-relaxed">Rooftop gardens absorb rainwater, reducing urban runoff and stress on drainage systems.</p>
                    </div>
                </div>
            </section>

            <!-- Testimonials Section -->
            <section class="py-16 glass-white rounded-3xl shadow-2xl mb-12 scroll-reveal">
                <h2 class="text-4xl font-bold text-center text-gray-900 mb-12">What Our Users Say</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-8 px-8">
                    <div class="glass p-8 rounded-2xl border-l-4 border-green-500 hover-lift">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-green-500 rounded-full flex items-center justify-center text-white font-bold mr-4">
                                R
                            </div>
                            <div>
                                <p class="font-semibold text-gray-900">Rohan P.</p>
                                <p class="text-sm text-gray-600">Mumbai</p>
                            </div>
                        </div>
                        <p class="italic text-gray-600 leading-relaxed">"GharBageecha made planning my rooftop garden so easy! The personalized plan helped me choose the right crops and get started without any hassle."</p>
                    </div>
                    <div class="glass p-8 rounded-2xl border-l-4 border-green-500 hover-lift" style="animation-delay: 0.2s;">
                        <div class="flex items-center mb-4">
                            <div class="w-12 h-12 bg-lime-500 rounded-full flex items-center justify-center text-white font-bold mr-4">
                                A
                            </div>
                            <div>
                                <p class="font-semibold text-gray-900">Ananya S.</p>
                                <p class="text-sm text-gray-600">Delhi</p>
                            </div>
                        </div>
                        <p class="italic text-gray-600 leading-relaxed">"I love the community dashboard! I've connected with other gardeners in my city and we now share tips and even seeds. It's a great platform."</p>
                    </div>
                </div>
            </section>
        </div>

        <!-- Planner Page -->
        <div id="planner" class="page-content container mx-auto hidden">
            <h1 class="text-5xl font-bold text-center text-gray-900 mb-12 animate-fadeInUp">Rooftop Farming Planner</h1>
            
            <!-- Progress Bar -->
            <div class="glass-white p-4 rounded-2xl mb-8">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm font-medium text-gray-600">Progress</span>
                    <span class="text-sm font-medium text-gray-600" id="progress-text">Step 1 of 3</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2">
                    <div class="progress-bar w-1/3" id="progress-bar"></div>
                </div>
            </div>
            
            <div id="planner-form-container" class="glass-white p-10 rounded-3xl shadow-2xl mb-12">
                <form id="rooftop-form" class="space-y-8">
                    <!-- Step 1: Basic Info -->
                    <div id="step-1" class="form-step animate-fadeInUp">
                        <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">
                            <i class="fas fa-home text-green-500 mr-3"></i>Rooftop Details
                        </h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="animate-fadeInLeft">
                                <label for="rooftop-width" class="block text-sm font-semibold text-gray-600 mb-2">
                                    <i class="fas fa-ruler-horizontal text-green-500 mr-2"></i>Rooftop Width (meters)
                                </label>
                                <input type="number" id="rooftop-width" name="rooftop-width" placeholder="e.g., 10" 
                                       class="form-input mt-2 p-4 block w-full rounded-xl shadow-lg">
                            </div>
                            <div class="animate-fadeInRight">
                                <label for="rooftop-length" class="block text-sm font-semibold text-gray-600 mb-2">
                                    <i class="fas fa-ruler-vertical text-green-500 mr-2"></i>Rooftop Length (meters)
                                </label>
                                <input type="number" id="rooftop-length" name="rooftop-length" placeholder="e.g., 20" 
                                       class="form-input mt-2 p-4 block w-full rounded-xl shadow-lg">
                            </div>
                            <div class="animate-fadeInLeft" style="animation-delay: 0.2s;">
                                <label for="sunlight-hours" class="block text-sm font-semibold text-gray-600 mb-2">
                                    <i class="fas fa-sun text-green-500 mr-2"></i>Daily Sunlight Hours
                                </label>
                                <input type="number" id="sunlight-hours" name="sunlight-hours" placeholder="e.g., 6" 
                                       class="form-input mt-2 p-4 block w-full rounded-xl shadow-lg">
                            </div>
                            <div class="animate-fadeInRight" style="animation-delay: 0.2s;">
                                <label for="load-capacity" class="block text-sm font-semibold text-gray-600 mb-2">
                                    <i class="fas fa-weight-hanging text-green-500 mr-2"></i>Load Capacity (kg/m²)
                                </label>
                                <input type="number" id="load-capacity" name="load-capacity" placeholder="e.g., 150" 
                                       class="form-input mt-2 p-4 block w-full rounded-xl shadow-lg">
                            </div>
                        </div>
                        <div class="mt-10 flex justify-end">
                            <button type="button" id="next-step-1" class="btn-primary text-white font-bold py-4 px-10 rounded-full shadow-2xl hover-glow">
                                Next <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 2: Location -->
                    <div id="step-2" class="form-step hidden">
                        <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center animate-fadeInUp">
                            <i class="fas fa-map-marker-alt text-green-500 mr-3"></i>Location Details
                        </h2>
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
                            <div class="animate-fadeInLeft">
                                <label for="city" class="block text-sm font-semibold text-gray-600 mb-2">
                                    <i class="fas fa-city text-green-500 mr-2"></i>City
                                </label>
                                <input type="text" id="city" name="city" placeholder="e.g., Mumbai" 
                                       class="form-input mt-2 p-4 block w-full rounded-xl shadow-lg">
                            </div>
                            <div class="animate-fadeInRight">
                                <label for="country" class="block text-sm font-semibold text-gray-600 mb-2">
                                    <i class="fas fa-flag text-green-500 mr-2"></i>Country
                                </label>
                                <input type="text" id="country" name="country" placeholder="e.g., India" 
                                       class="form-input mt-2 p-4 block w-full rounded-xl shadow-lg">
                            </div>
                        </div>
                        <div class="flex justify-between mt-10">
                            <button type="button" id="prev-step-2" class="bg-gray-500 text-white font-bold py-4 px-10 rounded-full shadow-2xl hover:bg-gray-600 transition-all hover-lift">
                                <i class="fas fa-arrow-left mr-2"></i>Previous
                            </button>
                            <button type="button" id="next-step-2" class="btn-primary text-white font-bold py-4 px-10 rounded-full shadow-2xl hover-glow">
                                Next <i class="fas fa-arrow-right ml-2"></i>
                            </button>
                        </div>
                    </div>

                    <!-- Step 3: Usage and Submit -->
                    <div id="step-3" class="form-step hidden">
                        <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center animate-fadeInUp">
                            <i class="fas fa-cogs text-green-500 mr-3"></i>Current Usage
                        </h2>
                        <div class="animate-fadeInUp">
                            <label for="current-usage" class="block text-sm font-semibold text-gray-600 mb-2">
                                <i class="fas fa-list text-green-500 mr-2"></i>Current Rooftop Usage
                            </label>
                            <select id="current-usage" name="current-usage" 
                                    class="form-input mt-2 p-4 block w-full rounded-xl shadow-lg">
                                <option value="empty">Empty space</option>
                                <option value="leisure">Leisure area (e.g., seating)</option>
                                <option value="solar">Solar panels</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div class="flex justify-between mt-10">
                            <button type="button" id="prev-step-3" class="bg-gray-500 text-white font-bold py-4 px-10 rounded-full shadow-2xl hover:bg-gray-600 transition-all hover-lift">
                                <i class="fas fa-arrow-left mr-2"></i>Previous
                            </button>
                            <button type="button" id="generate-gemini-plan-btn" class="btn-primary text-white font-bold py-4 px-10 rounded-full shadow-2xl hover-glow animate-pulse-custom">
                                <i class="fas fa-magic mr-2"></i>Generate Plan with ✨Gemini
                            </button>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Results Section -->
            <div id="planner-results" class="glass-white p-10 rounded-3xl shadow-2xl hidden">
                <h2 class="text-4xl font-bold text-gray-900 mb-8 text-center animate-fadeInUp">
                    <i class="fas fa-clipboard-list text-green-500 mr-3"></i>Your Rooftop Farming Plan
                </h2>
                <div class="space-y-8">
                    <div class="glass p-6 rounded-2xl hover-lift animate-fadeInLeft">
                        <h3 class="text-2xl font-bold text-green-500 mb-4">
                            <i class="fas fa-tools mr-2"></i>Recommended Farming Method
                        </h3>
                        <div id="method-recommendation" class="text-gray-600 leading-relaxed">
                            <div class="loading-dots">Loading</div>
                        </div>
                    </div>
                    <div class="glass p-6 rounded-2xl hover-lift animate-fadeInRight">
                        <h3 class="text-2xl font-bold text-green-500 mb-4">
                            <i class="fas fa-carrot mr-2"></i>Suggested Crops
                        </h3>
                        <ul id="crop-suggestions" class="list-disc list-inside text-gray-600 leading-relaxed">
                            <div class="loading-dots">Loading</div>
                        </ul>
                    </div>
                    <div class="glass p-6 rounded-2xl hover-lift animate-fadeInLeft">
                        <h3 class="text-2xl font-bold text-green-500 mb-4">
                            <i class="fas fa-chart-line mr-2"></i>Estimated ROI & Impact
                        </h3>
                        <div id="roi-estimate" class="text-gray-600 mb-4 leading-relaxed">
                            <div class="loading-dots">Loading</div>
                        </div>
                        <div id="impact-estimate" class="text-gray-600 leading-relaxed">
                            <div class="loading-dots">Loading</div>
                        </div>
                    </div>
                    <div class="glass p-6 rounded-2xl hover-lift animate-fadeInRight">
                        <h3 class="text-2xl font-bold text-green-500 mb-4">
                            <i class="fas fa-drafting-compass mr-2"></i>Layout & Setup
                        </h3>
                        <div id="layout-plan" class="text-gray-600 mb-4 leading-relaxed">
                            <div class="loading-dots">Loading</div>
                        </div>
                        <div id="vendor-suggestions" class="text-gray-600 leading-relaxed">
                            <div class="loading-dots">Loading</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Community Page -->
        <div id="community" class="page-content container mx-auto hidden">
            <h1 class="text-5xl font-bold text-center text-gray-900 mb-12 animate-fadeInUp">Community Dashboard</h1>
            <div id="auth-status" class="text-center text-sm glass-white p-3 rounded-xl mb-6 animate-fadeInUp"></div>

            <!-- Sample Users Section -->
            <section class="glass-white p-8 rounded-3xl shadow-2xl mb-12 max-w-4xl mx-auto animate-fadeInUp">
                <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">
                    <i class="fas fa-users text-green-500 mr-3"></i>Rooftop Farmers in Your Locality
                </h2>
                <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6">
                    <div class="flex items-center p-6 glass rounded-2xl hover-lift card-hover">
                        <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-lime-500 rounded-full flex items-center justify-center text-white font-bold text-xl mr-4">
                            J
                        </div>
                        <div>
                            <p class="font-semibold text-gray-900 text-lg">Jane Doe</p>
                            <p class="text-sm text-gray-600">Hydroponics Enthusiast</p>
                        </div>
                    </div>
                    <div class="flex items-center p-6 glass rounded-2xl hover-lift card-hover" style="animation-delay: 0.1s;">
                        <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-green-600 rounded-full flex items-center justify-center text-white font-bold text-xl mr-4">
                            J
                        </div>
                        <div>
                            <p class="font-semibold text-gray-900 text-lg">John Smith</p>
                            <p class="text-sm text-gray-600">Container Gardener</p>
                        </div>
                    </div>
                    <div class="flex items-center p-6 glass rounded-2xl hover-lift card-hover" style="animation-delay: 0.2s;">
                        <div class="w-16 h-16 bg-gradient-to-r from-lime-500 to-green-500 rounded-full flex items-center justify-center text-white font-bold text-xl mr-4">
                            P
                        </div>
                        <div>
                            <p class="font-semibold text-gray-900 text-lg">Priya Sharma</p>
                            <p class="text-sm text-gray-600">Expert on Indian crops</p>
                        </div>
                    </div>
                </div>
            </section>

            <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 max-w-6xl mx-auto">
                <!-- Live Community Chat -->
                <div class="glass-white p-8 rounded-3xl shadow-2xl flex flex-col h-[70vh] animate-fadeInLeft">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">
                        <i class="fas fa-comments text-green-500 mr-3"></i>Live Community Chat
                    </h2>
                    <div id="community-messages" class="flex-grow overflow-y-auto mb-6 p-6 space-y-4 rounded-2xl glass shadow-inner">
                        <p class="text-center text-gray-600">
                            <div class="loading-dots">Loading messages</div>
                        </p>
                    </div>
                    <form id="message-form" class="flex space-x-3">
                        <input type="text" id="message-input" placeholder="Type your message..." 
                               class="form-input flex-grow rounded-xl shadow-lg p-3">
                        <button type="submit" class="btn-primary text-white font-bold py-3 px-6 rounded-xl shadow-lg hover-glow">
                            <i class="fas fa-paper-plane"></i>
                        </button>
                    </form>
                </div>

                <!-- AI Assistant -->
                <div class="glass-white p-8 rounded-3xl shadow-2xl flex flex-col h-[70vh] animate-fadeInRight">
                    <h2 class="text-3xl font-bold text-gray-900 mb-6 text-center">
                        <i class="fas fa-robot text-green-500 mr-3"></i>Ask our AI Assistant
                    </h2>
                    <div id="ai-chat-container" class="flex-grow overflow-y-auto mb-6 p-6 space-y-4 rounded-2xl glass shadow-inner">
                        <div class="text-sm glass p-4 rounded-2xl shadow-sm self-start max-w-xs md:max-w-md animate-fadeInUp">
                            <p class="font-bold text-gray-900 flex items-center">
                                <i class="fas fa-robot text-green-500 mr-2"></i>AI Assistant
                            </p>
                            <p class="text-gray-600 mt-2">Hello! I'm here to help you with your rooftop gardening questions. Ask me anything!</p>
                        </div>
                    </div>
                    <form id="ai-form" class="flex space-x-3">
                        <input type="text" id="ai-question-input" placeholder="Ask a question..." 
                               class="form-input flex-grow rounded-xl shadow-lg p-3">
                        <button type="submit" id="ask-ai-btn" class="btn-primary text-white font-bold py-3 px-6 rounded-xl shadow-lg hover-glow">
                            <i class="fas fa-magic mr-1"></i>✨
                        </button>
                    </form>
                </div>
            </div>
        </div>

        <!-- Resources Page -->
        <div id="resources" class="page-content container mx-auto hidden">
            <h1 class="text-5xl font-bold text-center text-gray-900 mb-12 animate-fadeInUp">Resources & Blog</h1>
            <div class="space-y-8 max-w-4xl mx-auto">
                <article class="glass-white p-8 rounded-3xl shadow-2xl hover-lift animate-fadeInLeft">
                    <div class="flex items-center mb-4">
                        <div class="w-16 h-16 bg-gradient-to-r from-green-500 to-lime-500 rounded-2xl flex items-center justify-center text-white text-2xl mr-4">
                            <i class="fas fa-flask"></i>
                        </div>
                        <div>
                            <h2 class="text-3xl font-bold text-green-500">Hydroponics 101: Your Guide to Soilless Farming</h2>
                            <p class="text-sm text-gray-600 mt-1">Published 2 days ago</p>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-6 leading-relaxed text-lg">Hydroponics is a method of growing plants using mineral nutrient solutions in water, without soil. It's perfect for urban spaces with limited area and load capacity. This guide covers the basics of setting up your first hydroponic system...</p>
                    <a href="#" class="btn-primary text-white px-6 py-3 rounded-xl font-medium hover-glow inline-flex items-center">
                        Read More <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </article>
                
                <article class="glass-white p-8 rounded-3xl shadow-2xl hover-lift animate-fadeInRight">
                    <div class="flex items-center mb-4">
                        <div class="w-16 h-16 bg-gradient-to-r from-lime-500 to-green-600 rounded-2xl flex items-center justify-center text-white text-2xl mr-4">
                            <i class="fas fa-hand-holding-usd"></i>
                        </div>
                        <div>
                            <h2 class="text-3xl font-bold text-green-500">Finding Government Subsidies for Urban Gardens</h2>
                            <p class="text-sm text-gray-600 mt-1">Published 1 week ago</p>
                        </div>
                    </div>
                    <p class="text-gray-600 mb-6 leading-relaxed text-lg">Many local and national governments offer incentives and subsidies to encourage urban farming. This article provides a list of common programs, how to apply, and success stories from around the world...</p>
                    <a href="#" class="btn-primary text-white px-6 py-3 rounded-xl font-medium hover-glow inline-flex items-center">
                        Read More <i class="fas fa-arrow-right ml-2"></i>
                    </a>
                </article>
            </div>
        </div>
    </main>

    <!-- Footer -->
    <footer class="glass text-gray-900 py-12 mt-16">
        <div class="container mx-auto text-center">
            <div class="mb-6">
                <div class="flex items-center justify-center space-x-2 mb-4">
                    <svg width="40" height="40" viewBox="0 0 64 64" fill="none" xmlns="http://www.w3.org/2000/svg" class="text-green-500">
                        <path d="M16 32L32 18L48 32V50C48 51.1 47.1 52 46 52H18C16.9 52 16 51.1 16 50V32Z" stroke="currentColor" stroke-width="3" fill="none"/>
                        <path d="M28 52V38H36V52" stroke="currentColor" stroke-width="3"/>
                        <path d="M40 12C40 8 44 6 48 6V12C48 16 44 18 40 18H34C34 14 36 12 40 12Z" stroke="currentColor" stroke-width="2" fill="none"/>
                    </svg>
                    <span class="text-2xl font-bold">Ghar<span class="text-lime-500">Bageecha</span></span>
                </div>
                <p class="text-lg">&copy; 2024 GharBageecha. All rights reserved.</p>
            </div>
            <div class="flex justify-center space-x-6">
                <a href="#" class="text-2xl hover:text-green-500 transition-colors hover-lift">
                    <i class="fab fa-twitter"></i>
                </a>
                <a href="#" class="text-2xl hover:text-green-500 transition-colors hover-lift">
                    <i class="fab fa-facebook-f"></i>
                </a>
                <a href="#" class="text-2xl hover:text-green-500 transition-colors hover-lift">
                    <i class="fab fa-instagram"></i>
                </a>
                <a href="#" class="text-2xl hover:text-green-500 transition-colors hover-lift">
                    <i class="fab fa-linkedin"></i>
                </a>
            </div>
        </div>
    </footer>

    <!-- Custom application script -->
    <script type="module">
        // Import Firebase libraries from CDN
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInWithCustomToken, signInAnonymously, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, addDoc, onSnapshot, serverTimestamp, query, orderBy } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";

        // Global variables provided by the Canvas environment
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'default-app-id';
        const firebaseConfig = typeof __firebase_config !== 'undefined' ? JSON.parse(__firebase_config) : {};
        const initialAuthToken = typeof __initial_auth_token !== 'undefined' ? __initial_auth_token : null;
        
        let app, db, auth, userId;

        // Create particles
        function createParticles() {
            const particlesContainer = document.getElementById('particles');
            const particleCount = 50;
            
            for (let i = 0; i < particleCount; i++) {
                const particle = document.createElement('div');
                particle.className = 'particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 3 + 's';
                particle.style.animationDuration = (Math.random() * 2 + 2) + 's';
                particlesContainer.appendChild(particle);
            }
        }

        // Scroll reveal animation
        function handleScrollReveal() {
            const reveals = document.querySelectorAll('.scroll-reveal');
            
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('revealed');
                    }
                });
            }, { threshold: 0.1 });
            
            reveals.forEach(reveal => {
                observer.observe(reveal);
            });
        }

        // Update progress bar
        function updateProgress(step) {
            const progressBar = document.getElementById('progress-bar');
            const progressText = document.getElementById('progress-text');
            const width = (step / 3) * 100;
            
            progressBar.style.width = width + '%';
            progressText.textContent = `Step ${step} of 3`;
        }

        // Initialize and authenticate Firebase
        async function initializeFirebase() {
            try {
                if (Object.keys(firebaseConfig).length > 0) {
                    app = initializeApp(firebaseConfig);
                    db = getFirestore(app);
                    auth = getAuth(app);
                    
                    if (initialAuthToken) {
                        await signInWithCustomToken(auth, initialAuthToken);
                    } else {
                        await signInAnonymously(auth);
                    }
                } else {
                    console.error("Firebase config is not available. Community features will be disabled.");
                    document.getElementById('auth-status').innerHTML = `
                        <i class="fas fa-exclamation-triangle text-yellow-500 mr-2"></i>
                        Community features are disabled due to missing configuration.
                    `;
                }
            } catch (error) {
                console.error("Error initializing Firebase:", error);
                document.getElementById('auth-status').innerHTML = `
                    <i class="fas fa-times-circle text-red-500 mr-2"></i>
                    Error initializing community features.
                `;
            }
            
            onAuthStateChanged(auth, (user) => {
                if (user) {
                    userId = user.uid;
                    document.getElementById('auth-status').innerHTML = `
                        <i class="fas fa-check-circle text-green-500 mr-2"></i>
                        Authenticated. Your User ID: ${userId}
                    `;
                    if (db) {
                        setupCommunityListener();
                    }
                } else {
                    document.getElementById('auth-status').innerHTML = `
                        <i class="fas fa-user-slash text-gray-500 mr-2"></i>
                        Not authenticated.
                    `;
                }
            });
        }

        // This function will fetch and display messages in real-time
        function setupCommunityListener() {
            const messagesRef = collection(db, `artifacts/${appId}/public/data/community_messages`);
            const messagesQuery = query(messagesRef);
            
            onSnapshot(messagesQuery, (snapshot) => {
                const messagesContainer = document.getElementById('community-messages');
                messagesContainer.innerHTML = '';
                
                if (snapshot.empty) {
                    messagesContainer.innerHTML = `
                        <div class="text-center text-gray-600 py-8">
                            <i class="fas fa-comments text-4xl mb-4 opacity-50"></i>
                            <p>No messages yet. Be the first to post!</p>
                        </div>
                    `;
                    return;
                }
                
                snapshot.forEach(doc => {
                    const messageData = doc.data();
                    const messageElement = document.createElement('div');
                    messageElement.className = 'glass p-4 rounded-2xl shadow-sm hover-lift animate-fadeInUp';
                    messageElement.innerHTML = `
                        <div class="flex items-start space-x-3">
                            <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-lime-500 rounded-full flex items-center justify-center text-white font-bold text-sm">
                                ${messageData.userId.charAt(0).toUpperCase()}
                            </div>
                            <div class="flex-1">
                                <p class="text-sm text-gray-900 leading-relaxed">${messageData.text}</p>
                                <p class="text-xs text-gray-600 mt-2 flex items-center">
                                    <i class="fas fa-user text-green-500 mr-1"></i>
                                    <span class="font-semibold">${messageData.userId}</span>
                                    <i class="fas fa-clock text-gray-400 ml-3 mr-1"></i>
                                    ${messageData.timestamp ? new Date(messageData.timestamp.seconds * 1000).toLocaleString() : 'Just now'}
                                </p>
                            </div>
                        </div>
                    `;
                    messagesContainer.appendChild(messageElement);
                });
                
                messagesContainer.scrollTop = messagesContainer.scrollHeight;
            }, (error) => {
                console.error("Error fetching messages:", error);
                document.getElementById('community-messages').innerHTML = `
                    <div class="text-center text-red-500 py-8">
                        <i class="fas fa-exclamation-triangle text-4xl mb-4"></i>
                        <p>Error loading messages.</p>
                    </div>
                `;
            });
        }

        // Add a new message to the community board
        async function sendMessage(e) {
            e.preventDefault();
            const messageInput = document.getElementById('message-input');
            const messageText = messageInput.value.trim();
            
            if (!messageText || !db || !userId) {
                console.error("Cannot send message. Database not ready or no text entered.");
                return;
            }
            
            try {
                const messagesRef = collection(db, `artifacts/${appId}/public/data/community_messages`);
                await addDoc(messagesRef, {
                    text: messageText,
                    userId: userId,
                    timestamp: serverTimestamp()
                });
                messageInput.value = '';
                
                // Add visual feedback
                const button = e.target.querySelector('button[type="submit"]');
                const originalHTML = button.innerHTML;
                button.innerHTML = '<i class="fas fa-check"></i>';
                button.classList.add('bg-green-600');
                
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.classList.remove('bg-green-600');
                }, 1000);
                
            } catch (error) {
                console.error("Error adding message to Firestore:", error);
            }
        }

        // Function to handle AI chat
        async function askGeminiAI(e) {
            e.preventDefault();
            const questionInput = document.getElementById('ai-question-input');
            const questionText = questionInput.value.trim();
            const aiChatContainer = document.getElementById('ai-chat-container');
            
            if (!questionText) {
                return;
            }
            
            // Append user message to the chat
            const userMessageElement = document.createElement('div');
            userMessageElement.className = 'text-sm glass p-4 rounded-2xl shadow-sm self-end max-w-xs md:max-w-md ml-auto animate-fadeInUp';
            userMessageElement.innerHTML = `
                <div class="flex items-start space-x-2">
                    <div class="flex-1">
                        <p class="font-bold text-gray-900 flex items-center">
                            <i class="fas fa-user text-blue-500 mr-2"></i>You
                        </p>
                        <p class="text-gray-600 mt-2">${questionText}</p>
                    </div>
                </div>
            `;
            aiChatContainer.appendChild(userMessageElement);
            
            // Add a loading message for the AI response
            const loadingElement = document.createElement('div');
            loadingElement.id = 'ai-loading';
            loadingElement.className = 'text-sm glass p-4 rounded-2xl shadow-sm self-start max-w-xs md:max-w-md animate-pulse';
            loadingElement.innerHTML = `
                <div class="flex items-start space-x-2">
                    <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-lime-500 rounded-full flex items-center justify-center text-white">
                        <i class="fas fa-robot text-sm"></i>
                    </div>
                    <div class="flex-1">
                        <p class="font-bold text-gray-900">AI Assistant</p>
                        <p class="text-gray-600 mt-2">
                            <span class="loading-dots">Thinking</span>
                        </p>
                    </div>
                </div>
            `;
            aiChatContainer.appendChild(loadingElement);
            aiChatContainer.scrollTop = aiChatContainer.scrollHeight;
            questionInput.value = '';
            
            const prompt = `You are an expert on rooftop gardening. A user has asked you the following question: "${questionText}". Please provide a concise, helpful, and friendly response.`;
            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });
            
            const payload = {
                contents: chatHistory
            };
            
            // Placeholder for API key - replace with actual key
            const apiKey = "YOUR_GEMINI_API_KEY_HERE";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            
            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });
                
                if (!response.ok) {
                    throw new Error(`API call failed with status: ${response.status}`);
                }
                
                const result = await response.json();
                
                // Remove loading message
                aiChatContainer.removeChild(loadingElement);
                
                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {
                    
                    const aiResponseText = result.candidates[0].content.parts[0].text;
                    
                    const aiMessageElement = document.createElement('div');
                    aiMessageElement.className = 'text-sm glass p-4 rounded-2xl shadow-sm self-start max-w-xs md:max-w-md animate-fadeInUp';
                    aiMessageElement.innerHTML = `
                        <div class="flex items-start space-x-2">
                            <div class="w-8 h-8 bg-gradient-to-r from-green-500 to-lime-500 rounded-full flex items-center justify-center text-white">
                                <i class="fas fa-robot text-sm"></i>
                            </div>
                            <div class="flex-1">
                                <p class="font-bold text-gray-900">AI Assistant</p>
                                <p class="text-gray-600 mt-2 leading-relaxed">${aiResponseText}</p>
                            </div>
                        </div>
                    `;
                    aiChatContainer.appendChild(aiMessageElement);
                } else {
                    const errorElement = document.createElement('div');
                    errorElement.className = 'text-sm glass p-4 rounded-2xl shadow-sm self-start max-w-xs md:max-w-md';
                    errorElement.innerHTML = `
                        <div class="flex items-start space-x-2">
                            <div class="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white">
                                <i class="fas fa-exclamation-triangle text-sm"></i>
                            </div>
                            <div class="flex-1">
                                <p class="font-bold text-red-800">AI Assistant</p>
                                <p class="text-red-600 mt-2">Error: No valid response from API.</p>
                            </div>
                        </div>
                    `;
                    aiChatContainer.appendChild(errorElement);
                }
            } catch (error) {
                console.error("Error asking AI:", error);
                
                const currentLoadingElement = document.getElementById('ai-loading');
                if (currentLoadingElement) {
                    currentLoadingElement.remove();
                }
                
                const errorElement = document.createElement('div');
                errorElement.className = 'text-sm glass p-4 rounded-2xl shadow-sm self-start max-w-xs md:max-w-md';
                errorElement.innerHTML = `
                    <div class="flex items-start space-x-2">
                        <div class="w-8 h-8 bg-red-500 rounded-full flex items-center justify-center text-white">
                            <i class="fas fa-exclamation-triangle text-sm"></i>
                        </div>
                        <div class="flex-1">
                            <p class="font-bold text-red-800">AI Assistant</p>
                            <p class="text-red-600 mt-2">Failed to get a response. Please try again later. Error: ${error.message}</p>
                        </div>
                    </div>
                `;
                aiChatContainer.appendChild(errorElement);
            } finally {
                aiChatContainer.scrollTop = aiChatContainer.scrollHeight;
            }
        }

        // Function to generate a comprehensive plan using the Gemini API
        async function generatePlanWithGemini() {
            const resultsDiv = document.getElementById('planner-results');
            resultsDiv.classList.remove('hidden');
            
            // Add loading animations
            document.getElementById('method-recommendation').innerHTML = '<div class="loading-dots">Generating plan</div>';
            document.getElementById('crop-suggestions').innerHTML = '<div class="loading-dots">Generating</div>';
            document.getElementById('roi-estimate').innerHTML = '<div class="loading-dots">Generating</div>';
            document.getElementById('impact-estimate').innerHTML = '<div class="loading-dots">Generating</div>';
            document.getElementById('layout-plan').innerHTML = '<div class="loading-dots">Generating</div>';
            document.getElementById('vendor-suggestions').innerHTML = '<div class="loading-dots">Generating</div>';
            
            resultsDiv.scrollIntoView({ behavior: 'smooth' });

            const width = parseFloat(document.getElementById('rooftop-width').value);
            const length = parseFloat(document.getElementById('rooftop-length').value);
            const sunlight = parseFloat(document.getElementById('sunlight-hours').value);
            const loadCapacity = parseFloat(document.getElementById('load-capacity').value);
            const currentUsage = document.getElementById('current-usage').value;
            const city = document.getElementById('city').value;
            const country = document.getElementById('country').value;

            // Simple validation
            if (isNaN(width) || isNaN(length) || isNaN(sunlight) || isNaN(loadCapacity) || !city || !country) {
                document.getElementById('planner-results').innerHTML = `
                    <div class="glass p-6 rounded-2xl bg-red-100 text-red-800 shadow-sm">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Please fill out all the required fields.
                    </div>
                `;
                return;
            }

            const prompt = `
                I am planning a rooftop garden with the following specifications:
                - Rooftop Area: ${width * length} m² (${width}m x ${length}m)
                - Daily Sunlight: ${sunlight} hours
                - Load Capacity: ${loadCapacity} kg/m²
                - Current Usage: ${currentUsage}
                - Location: City ${city}, Country ${country}

                Please act as a rooftop farming expert and generate a short and concise plan in JSON format. For each item, provide a summary of the plan using bullet points. The plan should be well-structured and include the following keys:
                - "methodRecommendation": a list of bullet points recommending and explaining the best farming method.
                - "cropSuggestions": a list of bullet points with suggested crops.
                - "roiEstimate": a list of bullet points with estimated ROI and savings.
                - "impactEstimate": a list of bullet points with estimated environmental impact.
                - "layoutPlan": a list of bullet points describing a potential layout plan.
                - "vendorSuggestions": a list of bullet points with suggestions for vendors and tools.
            `;

            let chatHistory = [];
            chatHistory.push({ role: "user", parts: [{ text: prompt }] });

            const payload = {
                contents: chatHistory,
                generationConfig: {
                    responseMimeType: "application/json",
                    responseSchema: {
                        type: "OBJECT",
                        properties: {
                            "methodRecommendation": { "type": "ARRAY", "items": { "type": "STRING" } },
                            "cropSuggestions": { "type": "ARRAY", "items": { "type": "STRING" } },
                            "roiEstimate": { "type": "ARRAY", "items": { "type": "STRING" } },
                            "impactEstimate": { "type": "ARRAY", "items": { "type": "STRING" } },
                            "layoutPlan": { "type": "ARRAY", "items": { "type": "STRING" } },
                            "vendorSuggestions": { "type": "ARRAY", "items": { "type": "STRING" } }
                        },
                        "propertyOrdering": ["methodRecommendation", "cropSuggestions", "roiEstimate", "impactEstimate", "layoutPlan", "vendorSuggestions"]
                    }
                }
            };

            // Placeholder for API key - replace with actual key
            const apiKey = "YOUR_GEMINI_API_KEY_HERE";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    throw new Error(`API call failed with status: ${response.status}`);
                }

                const result = await response.json();

                if (result.candidates && result.candidates.length > 0 &&
                    result.candidates[0].content && result.candidates[0].content.parts &&
                    result.candidates[0].content.parts.length > 0) {

                    const jsonString = result.candidates[0].content.parts[0].text;
                    const plan = JSON.parse(jsonString);

                    // Animate the results appearing
                    setTimeout(() => {
                        document.getElementById('method-recommendation').innerHTML = plan.methodRecommendation.map(p => `<li class="mb-2 flex items-start"><i class="fas fa-check-circle text-green-500 mr-2 mt-1"></i><span>${p}</span></li>`).join('');
                    }, 500);
                    
                    setTimeout(() => {
                        document.getElementById('crop-suggestions').innerHTML = plan.cropSuggestions.map(p => `<li class="mb-2 flex items-start"><i class="fas fa-seedling text-green-500 mr-2 mt-1"></i><span>${p}</span></li>`).join('');
                    }, 1000);
                    
                    setTimeout(() => {
                        document.getElementById('roi-estimate').innerHTML = plan.roiEstimate.map(p => `<li class="mb-2 flex items-start"><i class="fas fa-dollar-sign text-green-500 mr-2 mt-1"></i><span>${p}</span></li>`).join('');
                    }, 1500);
                    
                    setTimeout(() => {
                        document.getElementById('impact-estimate').innerHTML = plan.impactEstimate.map(p => `<li class="mb-2 flex items-start"><i class="fas fa-leaf text-green-500 mr-2 mt-1"></i><span>${p}</span></li>`).join('');
                    }, 2000);
                    
                    setTimeout(() => {
                        document.getElementById('layout-plan').innerHTML = plan.layoutPlan.map(p => `<li class="mb-2 flex items-start"><i class="fas fa-map text-green-500 mr-2 mt-1"></i><span>${p}</span></li>`).join('');
                    }, 2500);
                    
                    setTimeout(() => {
                        document.getElementById('vendor-suggestions').innerHTML = plan.vendorSuggestions.map(p => `<li class="mb-2 flex items-start"><i class="fas fa-store text-green-500 mr-2 mt-1"></i><span>${p}</span></li>`).join('');
                    }, 3000);

                } else {
                    document.getElementById('method-recommendation').innerHTML = `
                        <div class="text-red-600 flex items-center">
                            <i class="fas fa-exclamation-triangle mr-2"></i>
                            Error: No valid response from API.
                        </div>
                    `;
                }
            } catch (error) {
                console.error("Error generating plan:", error);
                document.getElementById('method-recommendation').innerHTML = `
                    <div class="text-red-600 flex items-center">
                        <i class="fas fa-exclamation-triangle mr-2"></i>
                        Failed to generate plan. Please try again later. Error: ${error.message}
                    </div>
                `;
            }
        }

        // Function to navigate between pages
        function showPage(pageId) {
            document.querySelectorAll('.page-content').forEach(page => {
                page.classList.add('hidden');
                page.style.opacity = '0';
            });
            
            const targetPage = document.getElementById(pageId);
            targetPage.classList.remove('hidden');
            
            // Animate page transition
            setTimeout(() => {
                targetPage.style.opacity = '1';
                targetPage.style.transform = 'translateY(0)';
            }, 50);
            
            if (pageId === 'community') {
                if (!db) {
                    initializeFirebase();
                }
            }
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Function to navigate between form steps
        function nextStep(currentStep) {
            const currentStepElement = document.getElementById(`step-${currentStep}`);
            const nextStepElement = document.getElementById(`step-${currentStep + 1}`);
            
            // Animate out current step
            currentStepElement.style.transform = 'translateX(-100%)';
            currentStepElement.style.opacity = '0';
            
            setTimeout(() => {
                currentStepElement.classList.add('hidden');
                nextStepElement.classList.remove('hidden');
                
                // Animate in next step
                nextStepElement.style.transform = 'translateX(100%)';
                nextStepElement.style.opacity = '0';
                
                setTimeout(() => {
                    nextStepElement.style.transform = 'translateX(0)';
                    nextStepElement.style.opacity = '1';
                }, 50);
            }, 300);
            
            updateProgress(currentStep + 1);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function prevStep(currentStep) {
            const currentStepElement = document.getElementById(`step-${currentStep}`);
            const prevStepElement = document.getElementById(`step-${currentStep - 1}`);
            
            // Animate out current step
            currentStepElement.style.transform = 'translateX(100%)';
            currentStepElement.style.opacity = '0';
            
            setTimeout(() => {
                currentStepElement.classList.add('hidden');
                prevStepElement.classList.remove('hidden');
                
                // Animate in previous step
                prevStepElement.style.transform = 'translateX(-100%)';
                prevStepElement.style.opacity = '0';
                
                setTimeout(() => {
                    prevStepElement.style.transform = 'translateX(0)';
                    prevStepElement.style.opacity = '1';
                }, 50);
            }, 300);
            
            updateProgress(currentStep - 1);
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Add event listeners for navigation and buttons
        document.addEventListener('DOMContentLoaded', () => {
            // Initialize animations and effects
            createParticles();
            handleScrollReveal();
            
            // Navigation event listeners
            document.getElementById('nav-home')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                showPage('home'); 
            });
            document.getElementById('nav-home-2')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                showPage('home'); 
            });
            document.getElementById('nav-planner')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                showPage('planner'); 
            });
            document.getElementById('nav-community')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                showPage('community'); 
            });
            document.getElementById('nav-resources')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                showPage('resources'); 
            });
            
            // Button event listeners
            document.getElementById('start-planner-btn')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                showPage('planner'); 
            });
            
            // Form navigation
            document.getElementById('next-step-1')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                nextStep(1); 
            });
            document.getElementById('prev-step-2')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                prevStep(2); 
            });
            document.getElementById('next-step-2')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                nextStep(2); 
            });
            document.getElementById('prev-step-3')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                prevStep(3); 
            });
            document.getElementById('generate-gemini-plan-btn')?.addEventListener('click', (e) => { 
                e.preventDefault(); 
                generatePlanWithGemini(); 
            });
            
            // Chat functionality
            document.getElementById('message-form')?.addEventListener('submit', sendMessage);
            document.getElementById('ai-form')?.addEventListener('submit', askGeminiAI);
            
            // Add navbar scroll effect
            window.addEventListener('scroll', () => {
                const navbar = document.getElementById('navbar');
                if (window.scrollY > 50) {
                    navbar.style.background = 'rgba(255, 255, 255, 0.95)';
                    navbar.style.backdropFilter = 'blur(20px)';
                } else {
                    navbar.style.background = 'rgba(255, 255, 255, 0.1)';
                    navbar.style.backdropFilter = 'blur(10px)';
                }
            });
            
            // Initialize progress
            updateProgress(1);
            
            // Initially show the home page
            showPage('home');
        });
    </script>
</body>
</html>